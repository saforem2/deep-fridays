<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Slides</title>
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/black.css" id="theme" />
    <link rel="stylesheet" href="plugin/highlight/zenburn.css" />
	<link rel="stylesheet" href="css/layout.css" />
	<link rel="stylesheet" href="plugin/customcontrols/style.css">
	<link rel="stylesheet" href="plugin/chalkboard/style.css">



    <script defer src="dist/fontawesome/all.min.js"></script>

	<script type="text/javascript">
		var forgetPop = true;
		function onPopState(event) {
			if(forgetPop){
				forgetPop = false;
			} else {
				parent.postMessage(event.target.location.href, "app://obsidian.md");
			}
        }
		window.onpopstate = onPopState;
		window.onmessage = event => {
			if(event.data == "reload"){
				window.document.location.reload();
			}
			forgetPop = true;
		}

		function fitElements(){
			const itemsToFit = document.getElementsByClassName('fitText');
			for (const item in itemsToFit) {
				if (Object.hasOwnProperty.call(itemsToFit, item)) {
					var element = itemsToFit[item];
					fitElement(element,1, 1000);
					element.classList.remove('fitText');
				}
			}
		}

		function fitElement(element, start, end){

			let size = (end + start) / 2;
			element.style.fontSize = `${size}px`;

			if(Math.abs(start - end) < 1){
				while(element.scrollHeight > element.offsetHeight){
					size--;
					element.style.fontSize = `${size}px`;
				}
				return;
			}

			if(element.scrollHeight > element.offsetHeight){
				fitElement(element, start, size);
			} else {
				fitElement(element, size, end);
			}		
		}


		document.onreadystatechange = () => {
			fitElements();
			if (document.readyState === 'complete') {
				if (window.location.href.indexOf("?export") != -1){
					parent.postMessage(event.target.location.href, "app://obsidian.md");
				}
				if (window.location.href.indexOf("print-pdf") != -1){
					let stateCheck = setInterval(() => {
						clearInterval(stateCheck);
						window.print();
					}, 250);
				}
			}
	};


        </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides"><section  data-markdown><script type="text/template"><!-- .slide: style="align: center; justify: center" class="has-dark-background drop" template="[[anl-template]]" data-background-color="#1c1c1c" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="background-color: #282828; border-radius: 8px; box-shadow: RGBA(0, 0, 0, 0.35) 0px 5px 15px; position: absolute; left: 12.5%; top: 41%; height: 18%; width: 75%; display: flex; flex-direction: column; align-items: center; justify-content: center" align="center">


## <span style="font-size:1.75em;">Generative Modeling and Efficient Sampling Techniques </span><!-- .element: style="font-weight: 900; line-height: 0.6em" -->

<a href="https://github.com/saforem2/Notes-Demo/blob/master/slides/demo/slides.md">
<i class="fab fa-github fa-1x" ></i>
<code><span style="color:#bdbdbd!important; background-color: #282828;">saforem2/deep-fridays</span></code>
</a> <!-- .element: style="line-height: 0.6em; margin-top: -0.1em; margin-bottom: 0.5em" -->
</div>

<div class="" style="text-align: center; position: absolute; left: 0%; top: 73%; height: 10%; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center" align="center">


<a href="https://samforeman.me">
<i class="fas fa-home" style=""></i>
<span style="color: #BDBDBD;">Sam Foreman</span>
</a>

<span style="font-size:0.8em; color:#505050; padding:0px; margin:0px; text-align:center!important;">2023-04-21</span>

&nbsp;

[Deep Fridays](https://www.cs.unibo.it/~asperti/deep_fridays.html)   
<span style="font-size:0.8em; color:#505050; padding:0px; margin:0px; text-align:center!important;">@ University of Bologna</span>

</div>


<div class="" style="position: absolute; left: 0%; top: 90%; height: 10%; width: 100%; display: flex; flex-direction: column; align-items: flex-end; justify-content: flex-end" align="right">

<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/Argonne_cmyk_white.svg" alt="Argonne National Laboratory" align="right">
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# About Me

- Computational scientist at ALCF<sup id="fnref:1" role="doc-noteref">1</sup>
- PhD in HEP / Particle Theory
- Current research:
  - Generative modeling for Lattice QCD
  - [Deep Learning Hamiltonian Monte Carlo](https://arxiv.org/abs/2105.03418)
  - Large-scale distributed training on supercomputers
  - [GenSLMs: Genome-scale language models reveal SARS-CoV-2 evolutionary dynamics](https://www.biorxiv.org/content/10.1101/2022.10.10.511571v2.abstract)
  - Large Scale Climate Modeling / large scale forecasting models
  - ML for Sub-Surface Fluid Flow Science
  - Quantifying and Propagating Model and Data Uncertainties in Complex Systems





<div class="footnotes" role="doc-endnotes">
<ol>
<li id="fn:1" role="doc-endnote" class="footnote"><p>

[ALCF ‚Äì People: Sam Foreman](https://alcf.anl.gov/about/people/sam-foreman)

</p></li><li id="fn:2" role="doc-endnote" class="footnote"><p>

[GenSLMs: Genome-scale language models reveal SARS-CoV-2 evolutionary dynamics](https://www.biorxiv.org/content/10.1101/2022.10.10.511571v2.abstract)

</p></li></ol>
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: style="text-align: left" class="has-dark-background drop" true" data-background-color="#1c1c1c" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="font-size: 1.1em; position: absolute; left: 10%; top: 10%; height: 75%; width: 90%; display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start" align="left">


# Overview

- Standard Model:
	-  E\&M ‚ö°üß≤ 
	- ‚öõÔ∏è Nuclear interactions (strong / weak force)
- _Quantum Chromodynamics_ (**QCD**):
	- Strong interaction between quarks and gluons in the nucleus
	- Analytical progress is _difficult_...


<div class="" style="width: 100%; position: absolute; left: 0%; top: 55%; height: 45%; display: flex; flex-direction: column; align-items: center; justify-content: center" align="center">


<split left="1" right="3">

<img src="https://github.com/saforem2/physicsSeminar/raw/main/assets/static/nucleus.svg" alt="nucleus" style="width: 25%; object-fit: fill">

<img src="https://github.com/saforem2/physicsSeminar/raw/main/assets/static/feynman.svg" alt="feynman" style="object-fit: scale-down">

</split>
</div>

</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Anomalous Magnetic Moment of the Muon<!-- .element: style="color: #f8f8f8; vertical-align: center; margin-top: 10%; text-shadow: 0px 0px 10px black" -->


$
\begin{equation}
a_{\mu} = \frac{(g_{\mu} - 2)}{2}
\end{equation}
$  <!-- .element: style="color: #EEEEEE; font-size: 1.5em; text-shadow: 0px 0px 10px black" id="note" --> 

New physics? <!-- .element: style="color: #f8f8f8; vertical-align: center; margin-top: 10%; text-shadow: 0px 0px 10px black" -->

<section data-background-video-loop data-background-video-muted data-background-video="https://d2r55xnwy6nx47.cloudfront.net/uploads/2021/04/Muon_2560_Lede.mp4">
</section>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: style="text-align: center; font-size: 1.1em; line-height: 2.5em" class="has-dark-background drop" data-background-color="#1c1c1c" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Markov Chain Monte Carlo (MCMC)

<p><b>Goal</b>: Generate <b>independent</b> samples distributed according to $\{x_{i}\} \sim p(x)$ </p> <!-- .element: style="display: table; margin: var(--r-block-margin) 0!important; background-color: #66bb6a; color: #000; border-radius: 4px; padding: 4px 4px; line-height: 1.25em; margin-left: auto; margin-right: auto; text-align: left!important; max-width: fit-content" -->

- target distribution<sup id="fnref:1" role="doc-noteref">1</sup>:

  \\[ p(x) \propto e^{-S(x)} \\]

- Want to calculate observables $\mathcal{O}$:

  \\[ \left\langle \mathcal{O}\right\rangle \propto \int \left[\mathcal{D}x\right]\hspace{4pt} {\mathcal{O}(x) e^{-S[x]}} \\]
  
- If we had <span style="color:#00CCFF;">independent</span> configurations, we could approximate the integral, with error $\sigma_{\mathcal{O}}^{2}$

  \\[ \hspace{20pt} \left\langle\mathcal{O}\right\rangle \textcolor{#00CCFF}{\simeq} \frac{1}{N}\sum_{n=1}^{N} \mathcal{O}(x_{n})
  \quad \textcolor{#00CCFF}{\Longrightarrow}\quad \sigma^{2}_{\mathcal{O}} = \frac{1}{N} \mathrm{Var}\left[\mathcal{O}(x)\right] \\]

<div class="" style="position: absolute; left: 65%; top: 30%; height: 30%; width: 40%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


<img src="https://raw.githubusercontent.com/saforem2/deep-fridays/main/assets/normal_distribution.dark.svg">
</div>



<div class="footnotes" role="doc-endnotes">
<ol>
<li id="fn:1" role="doc-endnote" class="footnote"><p>

Here, $S(x)$ is the action (~ potential energy) of our physical system

</p></li></ol>
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: style="text-align: left" class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Metropolis-Hastings Algorithm<sup id="fnref:MH" role="doc-noteref">1</sup>

```python
>>> import numpy as np
>>> NORM = np.sqrt(2 * np.pi ** 2)

>>> def loglikelihood(x: float) -> float:
	return np.exp(-0.5 * (x ** 2)) / NORM

>>> def metropolis_hastings(nsteps: int = 1000) -> list[float]:
	x = 0.  # initial state
	samples = []
	for n in range(nsteps):
	    # generate RANDOM proposal
		xp = x + np.random.randn()
		llhratio = loglikelihood(xp) / loglikelihood(x)
		# always accept if llhratio > 1
		# otherwise, accept with p ~ U[0, 1]
		if np.random.uniform() < llhratio:
			x = xp
		samples.append(x)
	return samples

>>> %timeit metropolis_hastings(int(1e6))  # 2023 MBP M2 Max
1.92 s ¬± 9.06 ms per loop (mean ¬± std. dev. of 7 runs, 1 loop each)

>>> %timeit metropolis_hastings(int(1e6))  # 2018 MBP i7
3.85 s ¬± 173 ms per loop (mean ¬± std. dev. of 7 runs, 1 loop each)
```

<div class="" style="border: 1px solid #66BB6A; border-radius: 8px; box-shadow: RGBA(0, 0, 0, 0.35) 0px 5px 15px; background-color: #202020; position: absolute; left: 65%; top: 20%; height: 13%; width: 25%; display: flex; flex-direction: column; align-items: center; justify-content: center" id="note">


$\begin{equation}
p(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}x^{2}}
\end{equation}$
</div>



<div class="footnotes" role="doc-endnotes">
<ol>
<li id="fn:MH" role="doc-endnote" class="footnote"><p>

[The Best of the 20th Century: Editors Name Top 10 Algorithms](https://archive.siam.org/pdf/news/637.pdf)

</p></li></ol>
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Results

<span id="large">

As $N\rightarrow\infty$, $\quad x \sim\mathcal{N}(0, \mathbb{1})$

</span>

<div align="center">
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/static/normal/samples-10.svg" width=32% align="center">
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/static/normal/samples-100.svg" width=32% align="center">
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/static/normal/samples-500.svg" width=32% align="center">
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/static/normal/samples-1000.svg" width=32% align="center">
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/static/normal/samples-10000.svg" width=32% align="center">
<!-- <img src="assets/static/normal/samples-1e5.svg" width=32% align="center"> -->
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/static/normal/samples-1e+06.svg" width=32% align="center">
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Hamiltonian Monte Carlo (HMC)<!-- .element: style="margin-left: auto; margin-right: auto" --> 


- Want to (sequentially) construct a chain of states $\\{x_{i}\\}$,  
  such that  as $N \rightarrow \infty$:
 
  \begin{equation}
  \\{x_{0}, x_{1}, x_{2}, \cdots \\} \rightarrow p(x)
  \end{equation}
  
- Recall, $p(x) = {e^{-S(x)}} / {Z}$

- <span style="color:#63ff5b;">Trick:</span>

	- Introduce _fictitious_ momentum $v \sim \mathcal{N}(0, \mathbb{1})$
	- Normally distributed **independent** of $x$, i.e.
 
  \begin{align}
  	p(x)p(v) &\propto e^{-S{(x)}} e^{-\frac{1}{2} v^{T}v}\\\\
   	&= e^{-\left[S(x) + \frac{1}{2} v^{T}{v}\right]} \\\\
   	&\textcolor{#63ff5b}{=} e^{-H(x, v)}
  \end{align}
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: style="text-align: left; line-height: 1.5em" class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Hamiltonian Monte Carlo (HMC)

- The joint distribution: $p(x, v) = p(x) p(v) \propto e^{-H(x, v)}$
 
	- We can evolve the $(\dot{x}, \dot{v})$ system to get new states $\\{x_{i}\\}$ **!!**

- Hamiltonian Dynamics:

$
\begin{equation}
  \dot{x} = \frac{\partial H}{\partial v}
  \quad \quad
  \dot{v} = - \frac{\partial H}{\partial x}
\end{equation}
$

<img src="./assets/hmc1.svg" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Leapfrog Integrator (HMC)

- We can numerically integrate the $(\dot{x}, \dot{v})$ system<sup id="fnref:1" role="doc-noteref">1</sup>for a single **leapfrog** step:

- Recall:

  $\begin{equation}
  \dot{x} = \partial_{v} H, \quad \text{and}\quad \dot{v} = - \partial_{x} H
  \end{equation}$
  


<div id="note">

<span id="blue" style="text-align:left!important;"><b>Leapfrog Step:</b> </span>$\hspace{15px}(x, \varepsilon) \rightarrow (x', v')$ 
1. $v_{0} \sim {\mathcal{N}(0, \mathbb{1})}\hspace{10px}$ <span style="color:#666666;"> start with random $v\hspace{10pt}$</span>
3. $v_{1} =  v_{0} - \frac{\varepsilon}{2} \partial_{x} S(x_{0})$
4. $x' = x + \varepsilon v_{1}$ 
5. $v' = v_{1} - \frac{\varepsilon}{2} \partial_{x} S(x')$
</div>



<div class="footnotes" role="doc-endnotes">
<ol>
<li id="fn:1" role="doc-endnote" class="footnote"><p>

Here, $\varepsilon$ is a chosen fixed step-size

</p></li></ol>
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# HMC Update <!-- .element: style="margin-left: auto; margin-right: auto" -->

- We form a _trajectory_ by chaining together $N_{\mathrm{LF}}$ leapfrog steps,
	- use $x'$ as our proposal in the Metropolis-Hastings accept / reject, $A(x'|x)$

\begin{align}
\Gamma: (x, v) \rightarrow v' &:= v - \frac{\varepsilon}{2} \partial_{x} S(x) \\\\
\Lambda: (x, v) \rightarrow x' &:= x + \varepsilon v
\end{align}

<img src="https://raw.githubusercontent.com/saforem2/deep-fridays/main/assets/hmc-leapfrog-step.light.svg" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<section data-background-iframe="https://chi-feng.github.io/mcmc-demo/app.html"
          data-background-interactive>
</section>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Issues with HMC

- What do we want in a good sampler?
  - <span id="blue">**Fast mixing**</span> (small autocorrelations)
  - <span id="blue">**Fast burn-in**</span> (quick convergence)

- Problems with HMC:
  - Energy levels selected randomly $\rightarrow$ **slow mixing**
  - Cannot easily traverse low-density zones $\rightarrow$ **slow convergence**


<img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/hmc_traj_eps025.svg" width=45%> <img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/hmc_traj_eps05.svg" width=45%>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# L2HMC: Leapfrog Layer

<split>
<img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/drawio/update_steps.svg" style="width:31%;align:left; margin:auto[[]];">
<img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/drawio/leapfrog_layer_dark2.svg" style="width:64%;align:right;">
<img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/drawio/network_functions.svg" style="width:90%;align:center;">
</split>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Algorithm

1. Initialization:

	1. Resample: $\textcolor{#66bb6a}{\mathbf{v} \sim \mathcal{N}(0, \mathbb{1})}$, $\textcolor{#F06292}{d\sim\mathcal{U}(+, -)}$
 
	2. Construct $\textcolor{#00CCFF}{\xi} =(\mathbf{x}, \textcolor{#66bb6a}{\mathbf{v}}, \textcolor{#F96292}{\pm})$

2. Generate <span style="color:#AE81FF;">proposal $\xi^{\ast}$</span> by passing <span style="color:#00CCFF;">initial $\xi$</span> through $N_{\mathrm{LF}}$ leapfrog layers:

  $\textcolor{#00CCFF} \xi \hspace{1pt}\xrightarrow[]{\tiny{\mathrm{LF} \text{ layer}}}\xi_{1} \longrightarrow\cdots \longrightarrow \xi_{N_{\mathrm{LF}}} = \textcolor{#AE81FF}{\xi^{\ast}}$ <!-- .element: style="width: fit-content; padding: auto; align: inherit" id="note" -->

4. Compute the Metropolis-Hastings (MH) acceptance (with Jacobian
   $\mathcal{J}$)<br>

  $A({\textcolor{#AE81FF}{\xi^{\ast}}}|{\textcolor{#00CCFF}{\xi}})=
  \mathrm{min}\left\\{1,
  \frac{p(\textcolor{#AE81FF}{\xi^{\ast}})}{p(\textcolor{#00CCFF}{\xi})}\mathcal{J}\left(\textcolor{#AE81FF}{\xi^{\ast}},\textcolor{#00CCFF}{\xi}\right)\right\\}$ <!-- .element: style="width: fit-content; padding: auto" id="note" -->

5. <span id="red">`if training`</span>: Evaluate the **loss function** $\mathcal{L}\gets \mathcal{L}\_{\theta}(\textcolor{#AE81FF}{\xi^{\ast}}, \textcolor{#00CCFF}{\xi})$ and backprop

6. Evaluate MH criteria and assign the next state in the chain according to

  $\mathbf{x}_{i+1}\gets
  \begin{cases}
    \textcolor{#AE81FF}{\mathbf{x}^{\ast}} \small{\text{ w/ prob }} A(\textcolor{#AE81FF}{\xi^{\ast}}|\textcolor{#00CCFF}{\xi}) \hspace{29pt}‚úÖ \\\\
    \textcolor{#00CCFF}{\mathbf{x}} \hspace{14px}\small{\text{ w/ prob }} 1 - A(\textcolor{#AE81FF}{\xi^{\ast}}|{\textcolor{#00CCFF}{\xi}}) \hspace{10pt}‚ùå
  \end{cases}
  $ <!-- .element: style="width: fit-content; padding: 4pt!important" id="note" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Toy Example: GMM $\in \mathbb{R}^{2}$ <!-- .element: style="margin-left: auto; margin-right: auto" -->

<img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/iso_gmm_chains.svg" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="line-height: 1.5em; position: absolute; left: 0%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


# Lattice Gauge Theory

- Link (gauge) variables: $U_{\mu}(n) = e^{i x_{\mu}(n)}$,  
  with $x_{\mu}(n) \in [-\pi,\pi)\.$

- Wilson Action:

  $\begin{align}
  S_{\beta}(x)
  &= \beta\sum_{P} \cos \textcolor{#00CCFF}{x_{P}}, \text{ with} \\\\
  \textcolor{#00CCFF}{x_{P}} &= \big[x_{\mu}(n) + x_{\nu}(n+\hat{\mu}) \\\\
  &\hspace{20pt} - x_{\mu}(n+\hat{\nu})-x_{\nu}(n)\big]
  \end{align}$
</div>

<div class="" style="position: absolute; left: 50%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: flex-end; justify-content: space-evenly" align="right">


<img src="https://raw.githubusercontent.com/saforem2/deep-fridays/main/assets/u1lattice.dark.svg">
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="line-height: 1.5em; font-size: 1.5em; position: absolute; left: 0%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: flex-start; justify-content: space-evenly" align="left">


- Critical Slowing Down  <!-- .element: style="color: RGB(59, 76, 192); font-weight: 500" -->
- Charge freezing <!-- .element: style="color: RGB(123,159,249); font-weight: 600" -->
- $Q$ gets stuck! <!-- .element: style="color: RGB(192,212,245); font-weight: 700" -->
- $Q \longrightarrow \text{ const.}$ as  $\beta\longrightarrow \infty$ <!-- .element: style="color: RGB(242, 203, 183); font-weight: 800" -->
- \# configs required to estimate errors <!-- .element: style="color: RGB(238, 132, 104); font-weight: 800" -->  
  **grows exponentially** $\textcolor{#ff5252}{\Longrightarrow}$
  
  $\begin{equation}
  \tau_{\mathrm{int}}^{Q} \longrightarrow \infty
  \end{equation}
  $
   <!-- .element: style="color: RGB(255,82,82); background-color: RGBA(255,82,82,0.15); padding: 8px" id="note" -->
</div>

<div class="" style="position: absolute; left: 50%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: flex-end; justify-content: space-evenly" align="right">


<img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/critical_slowing_down.svg">
</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Lattice QCD

<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/static/continuum.svg" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="position: absolute; left: 0%; top: 0%; height: 100%; width: 60%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


# How to train?

- We 



  &nbsp;
  
  **Discrete:** $\hspace{14pt}$ <span id="note" style="padding:4px; background:#F7C2CC; color:#1c1c1c; text-align:right; border-radius: 5pt; display:inline;">‚ùå $Q_{\mathbb{Z}} = \frac{1}{2\pi}\sum_{P} \left\lfloor x_{P}\right\rfloor\hspace{15px}\in\mathbb{Z}$</span> 

  &nbsp;
  
  <span id="green">Differentiable: $\hspace{2pt}$ <span id="note" style="padding:4px; background:#D0F3D5; color:#1c1c1c; display:inline; border-radius:5pt;">‚úÖ $Q_{\mathbb{R}} = \frac{1}{2\pi}\sum_{P} \sin x_{P}\in\mathbb{R}$ </span> 

  &nbsp;

  with $\left\lfloor x_{P}\right\rfloor = x_{P}-2\pi\left\lfloor\frac{x_{P}+\pi}{2\pi}\right\rfloor$ 
</div>

<div class="" style="position: absolute; left: 50%; top: 25%; height: 50%; width: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


<img src="https://raw.githubusercontent.com/saforem2/l2hmc-dwq25/main/docs/assets/plaq.drawio.svg" alt="" style="object-fit: scale-down">

</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Loss Function

- Want to maximize the expected squared charge difference:

  $\begin{equation}
  \mathcal{L}(\theta) = \textcolor{#228BE6}{\mathbb{E}_{p(\xi)}}\big[-\textcolor{#FA5252}{{\delta Q}}^{2}_{\textcolor{#FA5252}{\mathbb{R}}}(\xi', \xi)\cdot A(\xi'|\xi)\big]
  \end{equation}$
  
- Where $\delta Q_{\mathbb{R}}$ is the _tunneling rate_:
  $
  \begin{equation}
  \textcolor{#FA5252}{\delta Q_{\mathbb{R}}}(\xi',\xi)=\left|Q_{\mathbb{R}}(x') - Q_{\mathbb{R}}(x)\right|
  \end{equation}
  $

- $A(\xi'|\xi)$ is the probability of accepting the proposal $\xi'$:
  $
  \begin{equation}
  A(\xi'|\xi) = \mathrm{min}\left( 1, \frac{p(\xi')}{p(\xi)}\left|\frac{\partial \xi'}{\partial \xi^{T}}\right|\right)
  \end{equation}
  $
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="position: absolute; left: 0%; top: 0%; height: 40%; width: 55%; display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start" align="left">


# Integrated Autocorrelation time: $\tau_{\mathrm{int}}$ <!-- .element: style="margin-left: auto; margin-right: auto" -->

<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/autocorr_new.svg" alt="" style="margin-left: auto; margin-right: auto; display: flex; flex-direction: column; align-items: center; justify-content: center; align-self: center; object-fit: scale-down">

</div>

<div class="" style="position: absolute; left: 55%; top: 0%; height: 40%; width: 45%; display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start" align="left">


We can measure the performance by comparing $\tau_{\mathrm{int}}^{Q}$ for the
<span style="color:#FF2052">trained model</span> to <span
style="color:#9F9F9F;">HMC</span>.
</div>

<div class="" style="position: absolute; left: 0%; top: 50%; height: 30%; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/charge_histories.svg" alt="" style="object-fit: scale-down">

</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Integrated Autocorrelation Time

<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/tint1.svg" style="width:100%;">

<!-- .element: style="display: flex; flex-direction: column; align-items: center; justify-content: center" align="center" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Interpretation <!-- .element: style="margin-left: auto; margin-right: auto" -->

&nbsp;

<div class="" style="position: absolute; left: 0%; top: 12%; height: 20%; width: 33%; display: flex; flex-direction: column; align-items: flex-start; justify-content: space-evenly" align="left">


Deviation in $x_{P}$ <!-- .element: style="text-align: left" -->
</div>

<div class="" style="position: absolute; left: 33%; top: 12%; height: 20%; width: 33%; display: flex; flex-direction: column; align-items: center; justify-content: center" align="center">


Topological charge mixing <!-- .element: style="text-align: center" -->
</div>

<div class="" style="position: absolute; left: 66%; top: 12%; height: 20%; width: 33%; display: flex; flex-direction: column; align-items: flex-end; justify-content: space-evenly" align="right">


Artificial influx of energy <!-- .element: style="text-align: right" -->
</div>

<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/ridgeplots.svg" alt="" style="object-fit: scale-down">


<span style="font-size:0.7em;">
Illustration of how different observables evolve over a
single L2HMC trajectory.
</span>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Interpretation

<div class="" style="position: absolute; left: 0%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


Average plaquette $\langle x_{P}\rangle$ vs lf step
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/plaqsf_ridgeplot.svg" style="width:48%; align:left;" >  
</div>


<div class="" style="position: absolute; left: 50%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


Average energy $H - \sum\log|\mathcal{J}|$
<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/Hf_ridgeplot.svg"  style="width:48%; align:right;">  
</div>

<span style="font-size:0.8em;"><b>Fig.</b> Illustration of how the trained model artificially
increases the energy towards the middle of the trajectory, allowing the sampler
to tunnel between isolated sectors.</span>

</div>
</grid></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Plaquette analysis: $x_{P}$

<span style="text-align:left;">Deviation from $V\rightarrow\infty$ limit,  $x_{P}^{\ast}$</span>

<span style="text-align:right;">Average $\langle x_{P}\rangle$, with $x_{P}^{\ast}$ (dotted-lines)</span>

<img src="https://raw.githubusercontent.com/saforem2/physicsSeminar/main/assets/plaqsf_vs_lf_step1.svg" alt="" style="object-fit: scale-down" width="100%">


<small><b>Fig.</b> Plot showing how <b>average plaquette</b>, $\left\langle
x_{P}\right\rangle$ varies over a single trajectory for models trained at
different $\beta$, with varying trajectory lengths $N_{\mathrm{LF}}$</small>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="position: absolute; left: 0%; top: 0%; height: 100%; width: 60%; display: flex; flex-direction: column; align-items: flex-start; justify-content: space-evenly" align="left">


# 2D $U(1)$ Model: <!-- .element: style="margin-left: auto; margin-right: auto" -->

- `lattice.shape: [2, Nt, Nx]`
- maintain buffer of `Nb` chains, updated in parallel
	- `x.shape: [Nb, 2, Nt, Nx]`
- to deal with $x \in \mathbb{C}$, stack as: 
  `[x.cos(), x.sin()]`
- final shapes:
	- `v.shape: [Nb, 2, Nt, Nx]`
	- `x.shape: [Nb, 2, 2, Nt, Nx]`
</div>

<div class="" style="margin-left: auto; margin-right: auto; position: absolute; left: 60%; top: 0%; height: 100%; width: 40%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


<img src="https://raw.githubusercontent.com/saforem2/deep-fridays/main/assets/leapfrog-layer-vertical.light.svg" alt="" style="object-fit: scale-down">

</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# [<i class="fab fa-github fa-1x" ></i>](https://github.com/saforem2/l2hmc-qcd) [l2hmc-qcd](https://github.com/saforem2/l2hmc-qcd)

- [arXiv: 2105.03418](https://arxiv.org/abs/2105.03418)
- [arXiv: 2112.01582](https://arxiv.org/abs/2112.01582)
- [arXiv: 2112.01586](https://arxiv.org/abs/2112.01586)

- Source code publicly available

- Both `pytorch` and `tensorflow` implementations with support for distributed training, automatic checkpointing, etc.

- Generic interface, easily extensible

- <b>Work in progress</b> scaling up to 2D, 4D $SU(3)$
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="position: absolute; left: 0%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start" align="left">

	  
# Acknowledgements

### Collaborators:
 - Xiao-Yong Jin
 - James C. Osborn

### References:
 - [Link to slides](https://bit.ly/l2hmc-ect2021)
 - [Link to github](https://github.com/saforem2/l2hmc-qcd)
 - [reach out!](mailto://foremans@anl.gov)
 - [Link to HMC demo](https://chi-feng.github.io/mcmc-demo/app.html)
 - [arXiv:2105.03418](https://arxiv.org/abs/2002.02428)
 - [arXiv:2002.02428](https://arxiv.org/abs/2002.02428)

</div>

<div class="" style="position: absolute; left: 50%; top: 0%; height: 100%; width: 50%; display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start" align="left">


## Huge thank you to:
 - Yannick Meurice
 - Norman Christ
 - Akio Tomiya
 - Luchang Jin
 - Chulwoo Jung
 - Peter Boyle
 - Taku Izubuchi
 - ECP-CSD group
 - ALCF Staff + Datascience Group

</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: style="text-align: left!important; align: left!important" class="has-dark-background drop" data-background-color="#1c1c1c" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Thank you!

<div class="" style="border: 1px solid red; position: absolute; left: 0%; top: 90%; height: 10%; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center" >

<split even gap="10%">

[<i class="fas fa-home"></i>](https://samforeman.me) <!-- .element: style="text-align: left" -->
[<i class="fab fa-twitter"></i>](https://www.twitter.com/saforem2) <!-- .element: style="text-align: center" -->
[<i class="far fa-paper-plane"></i>](mailto:///foremans@anl.gov) <!-- .element: style="text-align: right" -->
</split>

</div>

- Feel free to reach out! <br>
<split gap="2">

   [<i class="fab fa-twitter"></i>](https://www.twitter.com/saforem2)
   [<i class="far fa-paper-plane"></i>](mailto:///foremans@anl.gov)
   [<i class="fas fa-home"></i>](https://samforeman.me)
</split>

<div class="callout callout-color1">
<div class="callout-title">
<div class="callout-icon">

:fas_info-circle:

</div>
<div class="callout-title-inner">

Acknowledgements

</div>
</div>
<div class="callout-content">

This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357.

</div>
</div>
<!-- .element: style="max-width: 90%; text-align: left" -->
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Links / References:

- [‚ÄòLast Hope‚Äô Experiment Finds Evidence for Unknown Particles  Quanta Magazine](https://www.quantamagazine.org/last-hope-experiment-finds-evidence-for-unknown-particles-20210407/)
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Backup Slides
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

# Contributions

- Calculate using first principles from Lattice QCD (LQCD)
- LQCD _may_ be able to resolve the current tension between the standard models' experiments and predictions
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

Hadronic Vacuum Polarization (HVP) Contribution
- The blobs (quark loops) represent all possible intermediate hadronic states ($\rho$, $\pi\pi$, $\ldots$)
  - Not calculable in perturbation theory
- Can be calculated from:
   - First principles using **lattice QCD**
$a_{\mu}(\mathrm{HVP}) = \left(\frac{\alpha}{\pi}\right)^{2}\int_{0}^{\infty} dq^{2}\, f(q^{2}) \hat{\Pi}(q^{2})$ <!-- .element: style="text-align: center!important" -->


<u>**One Photon Correction**</u> <!-- .element: style="color: #888888" -->

$\mu$ emits and reabsorbs a virtual photon (largest effect) 

<u>**Hadronic Vacuum Polarization**</u> <!-- .element: style="color: #888888" -->

Virtual photon splits into (anti)-hadron pair (quarks, hard to calculate)
<img src="https://raw.githubusercontent.com/saforem2/anl-job-talk/main/docs/assets/feynman.svg" alt="" style="object-fit: scale-down">
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<div class="" style="position: absolute; left: 0%; top: 0%; height: 100%; width: 60%; display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start" align="left">


# 4D $SU(3)$ Model <!-- .element: style="margin-left: auto; margin-right: auto" -->

- link variables, $U_{\mu}(x) \in SU(3)$, $P_{\mu}(x) \in \mathfrak{su}(3)$
- `lattice.shape: [4, Nt, Nx, Ny, Nz, 3, 3]`
- again, update `Nb` in parallel: `batch.shape: [Nb, 4, Nt, Nx, Ny, Nz, 3, 3]`

</div>

<div class="" style="margin-left: auto; margin-right: auto; position: absolute; left: 60%; top: 0%; height: 100%; width: 40%; display: flex; flex-direction: column; align-items: center; justify-content: center" >


<img src="https://raw.githubusercontent.com/saforem2/deep-fridays/main/assets/leapfrog-layer-vertical.light.svg" alt="" style="object-fit: scale-down">

</div>
</div></script></section><section  data-markdown><script type="text/template"><!-- .slide: class="drop" template="anl-default-bologna" -->
<div class="" style="position: absolute; left: 0px; top: 0px; height: 700px; width: 960px; min-height: 700px; display: flex; flex-direction: column; align-items: center; justify-content: center" absolute="true">

<style>

:root {
    --callout-radius:5px;
    --admonition-margin-top: 1.5625em;
    --admonition-margin-bottom: var(--admonition-margin-top);
    --admonition-margin-top-lp: 0px;
    --admonition-margin-bottom-lp: 12px;
    --r-math-color:#FAFAFA;
    --cm-inline-background: #242424;
    --cm-inline-foreground: #00CCFF;
    --r-heading-text-transform: none;
    --primaryBorderColor: #666666;
    --r-main-background-color: #1c1c1c!important;
    --r-heading-letter-spacing: -0.45px;
    --r-heading-word-spacing: 0.5px;
    --r-heading-text-transform: none;
    --r-heading-text-shadow: none;
    --r-heading-font-weight: 700;
    --r-heading1-text-shadow: none;
    --r-main-font-size: 22px;
    --r-main-line-height: 1.5em;
    --r-monospace-font-size: 18px;
    --r-heading1-size: 1.33em;
    --r-heading2-size: 1.25em;
    --r-heading3-size: 1.2em;
    --r-heading4-size: 1.15em;
    --r-heading5-size: 1.05em;
    --r-heading6-size: 1.025em;
    --r-heading-line-height:1.5em;
    --r-main-font-family: 'Inter';
    --r-code-font: "JuliaMono", "agave Nerd Font", "Monaco", "Hack", "VictorMono", monospace;
    --r-link-color: #03A9F4;
    --r-link-color-dark: #f92672;
    --r-link-color-hover: #63ff51;
    --r-accent-color: #77CA29;
    --r-controls-color: #228BE6;
    --r-progress-color: #404040;
    --r-header-accent: #353535;
    --r-selection-background-color: RGBA(255, 255, 0, 0.15);
    --r-selection-color: RGB(255, 255, 0);
    --r-main-color: #c8c8c8;
    --text-muted: #757575;
    --text-faint: #404040;
    --r-heading-color: #FFF;
    --r-background-color: #1c1c1c;
    --cm-keyword: #c792ea;
    --cm-atom: #f78c6c;
    --cm-number: #ff5370;
    --cm-type: #decb6b;
    --cm-def: #82aaff;
    --cm-property: #c792ea;
    --cm-variable: #f07178;
    --cm-variable-2: #EEFFFF;
    --cm-variable-3: #f07178;
    --cm-definition: #82aaff;
    --cm-callee: #89ddff;
    --cm-qualifier: #decb6b;
    --cm-operator: #89ddff;
    --cm-hr: #98e342;
    --cm-link: #696d70;
    --cm-header: #da7dae;
    --cm-builtin: #ffcb6b;
    --cm-meta: #ffcb6b;
    --cm-matching-bracket: #FFFFFF;
    --cm-tag: #ff5370;
    --cm-tag-in-comment: #ff5370;
    --cm-string-2: #f07178;
    --cm-bracket: #ff5370;
    --cm-comment: #676e95;
    --cm-string: #c3e88d;
    --cm-attribute: #c792ea;
    --cm-attribute-in-comment: #c792ea;
    --cm-background-color: #1c1c1c;
    --cm-active-line-background-color: #353a50;
    --cm-foreground-color: #AE81FF;
    --code-normal: #AE81FF;
    -webkit-font-smoothing:subpixel-antialiased;
    --font-smoothing:subpixel-antialiased;
    --chart-color-1: #ff00ff;
    --chart-color-x: RGB(255.0,255.0,255.0);
	  --admonition-margin-top: 1.5625em;
	  --admonition-margin-bottom: var(--admonition-margin-top);
	  --admonition-margin-top-lp: 0px;
	  --admonition-margin-bottom-lp: 12px;
	  --callout-border-width: 0px;
	--callout-border-opacity: 0.25;
	--callout-padding: var(--size-4-3)¬†var(--size-4-3)¬†var(--size-4-3)¬†var(--size-4-6);
	--callout-radius: var(--radius-s);
	--callout-blend-mode: var(--highlight-mix-blend-mode);
	--callout-title-color: inherit;
	--callout-title-padding: 0;
	--callout-title-size: inherit;
	--callout-content-padding: 0;
	--callout-content-background: transparent;
	--callout-bug: var(--color-red-rgb);
	--callout-default: var(--color-blue-rgb);
	--callout-error: var(--color-red-rgb);
	--callout-example: var(--color-purple-rgb);
	--callout-fail: var(--color-red-rgb);
	--callout-important: var(--color-cyan-rgb);
	--callout-info: var(--color-blue-rgb);
	--callout-question: var(--color-yellow-rgb);
	--callout-success: var(--color-green-rgb);
	--callout-summary: var(--color-cyan-rgb);
	--callout-tip: var(--color-cyan-rgb);
	--callout-todo: var(--color-blue-rgb);
	--callout-warning: var(--color-orange-rgb);
	--callout-quote: 158, 158, 158;
	--callout-border-opacity: 0.25;
	--callout-padding: var(--size-4-3)¬†var(--size-4-3)¬†var(--size-4-3)¬†var(--size-4-6);
	--callout-radius: var(--radius-s);
	--callout-blend-mode: var(--highlight-mix-blend-mode);
	--callout-title-color: inherit;
	--callout-title-padding: 0;
	--callout-title-size: inherit;
	--callout-content-padding: 0;
	--callout-content-background: transparent;
	--callout-bug: var(--color-red-rgb);
	--callout-default: var(--color-blue-rgb);
	--callout-error: var(--color-red-rgb);
	--callout-example: var(--color-purple-rgb);
	--callout-fail: var(--color-red-rgb);
	--callout-important: var(--color-cyan-rgb);
	--callout-info: var(--color-blue-rgb);
	--callout-question: var(--color-yellow-rgb);
	--callout-success: var(--color-green-rgb);
	--callout-summary: var(--color-cyan-rgb);
	--callout-tip: var(--color-cyan-rgb);
	--callout-todo: var(--color-blue-rgb);
	--callout-warning: var(--color-orange-rgb);
	--callout-quote: 158, 158, 158;
}

.standout{
    background: var(--cm-background-color);
    padding:5px;
    font-weight:700;
    border-radius:6px;
}

.reveal pre {
  display:block;
  margin:auto;
  width:auto;
  font-family: var(--r-code-font);
  font-size: var(--r-monospace-font-size);
  padding: auto;
  white-space: pre-wrap;
}

.reveal p {
  margin:inherit;
  padding:auto!important;
}

.reveal pre code¬†{
    display: inline-block;
    top: 2px;
    white-space: pre;
    bottom: 2px;
    margin:auto;
    padding:auto;
    font-size: 0.8em;
    text-align: justify;
    /*letter-spacing: -0.45px!important;*/
    /*word-spacing: -0.5px!important;*/
}

.reveal {
    font-family: var(--r-main-font), sans-serif;
    font-size: var(--r-main-font-size);
    font-weight: normal;
    color: var(--r-main-color);
    background-color: var(--r-main-background-color);
}

.reveal blockquote p {
    color: var(--text-muted);
	box-shadow: RGBA(0, 0, 0, 0.35) 0px 5px 15x;
    font-style: normal !important;
    font-align: left;
    display: inline;
    text-align: left;
}

.reveal blockquote em{
  color: var(--text-muted);
  text-align: left;
}

.reveal blockquote {
  border-radius: 8px !important;
  margin: 0.5rem 0rem 0.5rem 0rem;
  text-align: left;
  padding-top: 1rem;
  padding-left: 2rem;
  padding-bottom: 1rem;
  padding-right: 2rem;
  width: auto;
  font-style: normal !important;
}

.reveal blockquote {
	font-size: unset;
	margin: auto;
	padding:auto;
}


.reveal ul, ol {
    text-align:left;
}

.reveal ul ul,
.reveal ul ol,
.reveal ol ol,
.reveal ol ul {
  text-align:left;
}

.reveal ul ul {
    list-style: circle;
}
.container {
  position: relative;
}

.make-it-pop {
  filter: drop-shadow(0 0 10px purple);
}

@media (max-width: 95%) {
  section {
    -webkit-flex-direction: column;
    flex-direction: column;
  }
}

.footer {
  font-size: 60%;
  vertical-align:bottom;
  color:#bdbdbd;
  font-weight:400;
}

#note {
	border-radius:8px;
	width: max-content;
	text-align:center;
	padding-top: 0.5em;
	padding-bottom: 0.5em;
	margin-top: 1em;
	margin-bottom: 1em;
	background-color:#282828;
	border-radius:8px;
	padding-left: 0.5em;
	padding-right: 0.5em;
	box-shadow: RGBA(0, 0, 0, 0.35) 0px 5px 15px;
}

#blue {
  color: #00CCFF;
}

#red {
  color: #FF5252;
}

.callout {
  border-style: none;
  border-color: RGBA(var(--callout-color), var(--callout-border-opacity));
  border-width: var(--callout-border-width);
  border-radius: var(--callout-radius);
  margin: 1em 0;
  mix-blend-mode: var(--callout-blend-mode);
  background-color: RGBA(var(--callout-color), 0.1);
  padding: var(--callout-padding);
}
.callout-title {
  font-size: var(--callout-title-size);
  color: RGB(var(--callout-color));
  background-color: RGB(var(--callout-color), 0.0);
  line-height: var(--line-height-tight);
  font-weight: 700;
}
.callout-content {
  overflow-x: auto;
  padding: auto;
  background-color: var(--callout-content-background);
}
.callout-icon {
  flex: 0 0 auto;
  padding: auto;
  display: flex;
  align-self: center;
  content:
}
.callout-icon .svg-icon {
  color: RGB(var(--callout-color));
}

.callout-title-inner {
  font-weight: var(--bold-weight);
  color: var(--callout-title-color);
}
.callout-fold {
  display: flex;
  align-items: center;
  padding-right: var(--size-4-2);
}

.reveal .code-wrapper code {
	width: 98%;
}
.reveal code {
  font-family: var(--r-code-font);
  text-transform: none;
  tab-size: 4;
  /*background-color:var(--cm-background-color);*/
  background-color: inherit;
  /*color: var(--cm-foreground-color); */
  border-radius:2px;
  /*letter-spacing: -0.45px!important;*/
  /*word-spacing: -0.5px!important;*/
  /*line-height: 0.9em;*/
}

.reveal pre code {
	padding: auto;
	border:none;
	border-radius:2px;
	font-size:0.9em;
	margin:auto;
	background: var(--cm-background-color);
}

.reveal p code {
  font-family: var(--r-code-font);
  text-transform: none;
  tab-size: 4;
  padding:auto;
  font-size:0.9em!important;
  color: var(--cm-inline-foreground);
  border-radius:3px;
}

mjx-container[jax="CHTML"][display="true"] mjx-math {
  /*color: var(--r-math-color);*/
  /*color:inherit!important;*/
  /*font-size:1.1em;*/
  /*line-height: 1.1em;*/
  margin-left: auto;
  margin-right: auto;
}

mjx-math {
  color: inherit!important;
  background: none!important;
  /*padding:unset;*/
  vertical-align:inherit;
}
#customcontrols > ul {
  display: none!important;
}

#customcontrols button {
  display: none!important;
}

.reveal .slides > section.present, .reveal .slides > section > section.present {
  /*min-height: 100% !important;*/
  /*display: flex !important;*/
  /*flex-direction: column !important;*/
  /*justify-content: center !important;*/
  /*position: absolute !important;*/
  /*top: 0 !important;*/
}

section > h1 {
  display: inline;
  /*position: absolute !important;(*/
  /*top: 0 !important;*/
  /*margin-left: auto !important;*/
  /*margin-right: auto !important;*/
  /*left: 0 !important;*/
  /*right: 0 !important;*/
}

h1 {
	/*border-bottom: 2px solid var(--r-header-accent);*/
	/*text-align: left!important;*/
	/*min-width: max-content;*/
	/*max-width: min-content;*/
}

.print-pdf .reveal .slides > section.present, .print-pdf .reveal .slides > section > section.present {
  min-height: 770px !important;
  position: relative !important;
}

.hljs {
    background: var(--cm-background-color) !important;
	font-size:inherit;
}

.hljs-float { 
	color: #00BFA5;
}

.hljs-main {
	color: #ff5252
}

.hljs-built_in {
  color: #63ff5b;
}

.hljs-comment, .hljs-quote, .hljs-deletion {
	color: #454545;
}

.hljs-params{
	color: #FD971F;
}

.hljs-meta {
	color: #AE81FF;
}

.hljs-string {
	color: #FFFF00;
}

strong {
	color: #FF5252!important;
	font-weight: 700;
}

ul {
	margin-left: 0;
	padding-left:1em;
}

ol {
	margin-left: 0;
	padding-left:1em;
}

.reveal .code-wrapper code {
 st white-space: unset;
}

.reveal pre {
white-space: pre-wrap;
}

.reveal sup {
	font-size: 0.75em;
}
.markdown-rendered code {
  /*color: var(--code-normal)!important;*/
  font-family: var(--font-monospace);
}
body.fallback-highlighting[class*="theme-"] .markdown-preview-view pre.cm-s-obsidian[class*="language-"],¬†body.fallback-highlighting[class*="theme-"] .markdown-preview-view code[class*="language-"], body.fallback-highlighting[class*="theme-"] .markdown-preview-view .HyperMD-codeblock, body.fallback-highlighting[class*="theme-"] .markdown-preview-view .cm-hmd-codeblock¬†{
  --font-monospace: var(--cm-font-monospace);
  color: var(--cm-foreground-color);
  font-family: var(--cm-font-monospace);
  font-weight: var(--cm-font-weight);
  /*line-height: var(--cm-line-height);*/
  /*font-size: var(--cm-font-size);*/
  white-space: var(--cm-wrap-lines);
}
.reveal .code-wrapper code {
  font-family: var(--cm-font-monospace);
}
/* Content */
/* Blockquotes */
.markdown-preview-view blockquote {
	padding: 0 0 0 var(--nested-padding);
	font-size: var(--blockquote-size);
}
.markdown-source-view.mod-cm6.is-live-preview .HyperMD-quote,
.markdown-source-view.mod-cm6 .HyperMD-quote {
	font-size: var(--blockquote-size);
}
.is-live-preview .cm-hmd-indent-in-quote {
	color: var(--text-faint);
}
/* Callouts */
.is-live-preview.is-readable-line-width > .cm-callout .callout {
	max-width: var(--max-width);
	margin: 0 auto;
}
.callout-icon {
	display: none;
}
.callout {
	background-color: var(--background-primary);
	margin-top: -24px;
	z-index: 200;
	width: fit-content;
	padding: 0 0.5em;
	margin-left: -0.75em;
	font-variant-caps: all-small-caps;
}
.callouts-outlined .callout .callout-title {
	background-color: var(--background-primary);
	margin-top: -24px;
	z-index: 200;
	width: fit-content;
	padding: 0 0.5em;
	margin-left: -0.75em;
	font-variant-caps: all-small-caps;
}
.callouts-outlined .callout {
	overflow: visible;
	--callout-border-width: 1px;
	--callout-border-opacity: 0.5;
	--callout-title-size: 0.8em;
	--callout-blend-mode: normal;
	background-color: transparent;
}
.callouts-outlined .cm-embed-block.cm-callout {
	padding-top: 12px;
}
.callouts-outlined .callout-content .callout {
	margin-top: 18px;
}
.callout[data-callout="custom-question-type"] {
	--callout-color:  '#FF5252';
	 --callout-icon: lucide-alert-circle;
 }
.callout[data-callout="my-comment"] {
	--callout-color: 99, 71, 214;
	--callout-icon: lucide-message-square;
	/* --callout-icon: message-o;
	// font-awesome */ 
	border: 3px solid RGBA(0, 0, 0, 0.5);
	border-radius: 5px;
	box-shadow: 20px 20px 40px RGBA(255, 0, 0, .5);
}
.row {
	display: flex;
}
.column {
	flex: 50%;
}
#left {
  margin: 0 0 5px 5px;
  text-align: left;
  float: left;
  z-index: -10;
  width: 48%;
  font-size: 0.85em;
}
#right {
  margin: 0 0 5px 0;
  float: right;
  max-width: 48%;
  text-align: left;
  z-index: -10;
  width: 48%;
  font-size: 0.85em;
}
#darkBack {
    background-color: #1c1c1c;
    color: #efefef;
    .reveal a {
        color: #F92672;
        transition: color 0.15s ease;
    }
    .reveal a:hover {
        color: var(--r-link-color-hover);
    }
}
.multiCol {
    display: table;
    table-layout: fixed; /* don't fudge depending on content */
    width: 100%;
    text-align: left; /* matter of taste, makes imho sense */
    .col {
        display: table-cell;
        vertical-align: top;
        width: 50%;
        padding: 2% 0 2% 3%; /* some vertical, and between columns */
        &:first-of-type { padding-left: 0; } /* there's nothing before col1 */
    }
}
.reveal em {
	color: #2196F3;
	font-weight: 700;
}
.reveal .code-wrapper {
	width: fit-content;
	white-space: normal;
}
:root {
  --hljs-selection: #ffff0020;
  --hljs-background: #1c1c1c;
  --hljs-text: #BDBDBD;
  --hljs-string: #ffff00;
  --hljs-number: #0dcdcd;
  --hljs-title: #40c057;
  --hljs-built_in: #F39CF4;
  --hljs-keyword: #f92672;
  --hljs-function: #FF79FF;
  --hljs-params: #FD971F;
  --hljs-comment: #404040;
}
/* Dark Orange Theme */
pre code {
  /*display: block;*/
  overflow-x: auto;
  line-height: inherit;
  font-size:inherit;
  background: var(--background);
  /*-webkit-text-size-adjust: none;*/
}
pre code *::selection,
.hljs::selection {
  background: var(--hljs-selection) !important;
}
.hljs {
  color: var(--hljs-text);
}
.hljs-string {
  color: var(--hljs-string);
}
.hljs-number {
  color: var(--hljs-number) !important;
}
.hljs-title {
  color: var(--hljs-title) !important;
}
.hljs-built_in {
  color: var(--hljs-built_in) !important;
}
.hljs-keyword {
  color: var(--hljs-keyword) !important;
}
.hljs-function > .hljs-keyword {
  color: var(--hljs-function) !important;
  font-style: italic;
}
.hljs-params,
.hljs-params,
.hljs-title.class_,
.hljs-class .hljs-title{
  color: var(--hljs-params);
}
.hljs-comment,
.hljs-deletion,
.hljs-meta {
  color: var(--hljs-comment);
}
.reveal ol,
.reveal dl,
.reveal ul {
	display: inline-block;
	text-align: left;
	margin: 0 0 0 1em;
}
#info {
    position: fixed;
    top: 5px;
    left: 5px;
}
.reveal ol,
.reveal dl,
.reveal ul {
	display: inline-block;
	text-align: left;
	margin: 0 0 0 1em;
}

.reveal ol {
list-style-type: decimal;
}

.reveal ul {
list-style-type: disc;
}

.reveal ul ul {
list-style-type: circle;
}

.reveal ul ul ul {
list-style-type: circle;
}

.reveal ul ul,
.reveal ul ol,
.reveal ol ol,
.reveal ol ul {
display: block;
  margin-left: 40px;
}

.reveal dt {
  font-weight: bold;
}

.reveal dd {
  margin-left: 40px;
}

#pink {
	color: #ff79b0;
}
#blue {
    color: #228BE6;
}
#bright {
    color: #00A2FF;
}
#cyan {
    color: #00CCFF;
}
#purple {
    color: #AE81ff;
}
#green {
    /*color: #63FF51;*/
	/*color: #65BB6A;*/
	color: #63ff5b;
}
#yellow {
    color: #FFFF00;
}
#lightpink {
    color: #E64980;
}
#pink {
	color:#F06292;
}
#pink {
	color: #F92672;
}
#red {
    color: #FA5252;
}
#grey {
    color: #666666;
}

.reveal pre {
    display: initial;
    margin: initial;
    width: auto;
    font-family: var(--r-code-font);
    font-size: var(--r-monospace-font-size);
    padding: auto;
    white-space: pre-wrap;
	box-shadow: unset;
}

.reveal .code-wrapper {
	width: auto;
}

.hljs-symbol,
.hljs-bullet,
.hljs-link,
.hljs-meta,
.hljs-selector-id,
.hljs-title {
	color: #06D6A0;
}

.reveal ol,
.reveal dl,
.reveal ul {
	display: inline-block;
	text-align: left;
	margin: 0 0 0 1em;
}

.reveal ol {
	list-style-type: decimal;
}

.reveal ul {
	list-style-type: disc;
}

.reveal ul ul {
	list-style-type: circle;
}

.reveal ul ul ul {
	list-style-type: square;
}

.reveal ul ul,
.reveal ul ol,
.reveal ol ol,
.reveal ol ul {
	display: block;
	margin-left: 40px;
}

.reveal p {
	margin: initial;
	padding: unset;
}

.footnotes {
	font-size:0.8em;
	border-top: 1px dashed #454545;
	text-align: justify;
	min-width: max-content;
	margin-left:0px;
	padding-left: 0px;
	padding-right: 15px;
	margin-top: 10%;
}

.footnotes > ol > li::marker {
    color: var(--r-link-color);
    content: counter(list-item) ": ";
    text-align: left;
}

</style>
</div></script></section></div>
    </div>

    <script src="dist/reveal.js"></script>

    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script src="plugin/zoom/zoom.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/math/math.js"></script>
	<script src="plugin/mermaid/mermaid.js"></script>
	<script src="plugin/chart/chart.min.js"></script>
	<script src="plugin/chart/plugin.js"></script>
	<script src="plugin/menu/menu.js"></script>
	<script src="plugin/customcontrols/plugin.js"></script>
	<script src="plugin/chalkboard/plugin.js"></script>

    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

	  function isLight(color) {
		let hex = color.replace('#', '');

		// convert #fff => #ffffff
		if(hex.length == 3){
			hex = `${hex[0]}${hex[0]}${hex[1]}${hex[1]}${hex[2]}${hex[2]}`;
		}

		const c_r = parseInt(hex.substr(0, 2), 16);
		const c_g = parseInt(hex.substr(2, 2), 16);
		const c_b = parseInt(hex.substr(4, 2), 16);
		const brightness = ((c_r * 299) + (c_g * 587) + (c_b * 114)) / 1000;
		return brightness > 155;
	}

	var bgColor = getComputedStyle(document.documentElement).getPropertyValue('--r-background-color').trim();
	var isLight = isLight(bgColor);

	if(isLight){
		document.body.classList.add('has-light-background');
	} else {
		document.body.classList.add('has-dark-background');
	}

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealZoom,
          RevealNotes,
          RevealMath.MathJax3,
		  RevealMermaid,
		  RevealChart,
		  RevealCustomControls,
		  RevealMenu,
		  RevealChalkboard, 
        ],


    	allottedTime: 120 * 1000,

		mathjax3: {
			mathjax: 'plugin/math/mathjax/tex-mml-chtml.js',
		},
		markdown: {
		  gfm: true,
		  mangle: true,
		  pedantic: false,
		  smartLists: false,
		  smartypants: false,
		},

		mermaid: {
			theme: isLight ? 'default' : 'dark',
		},

		customcontrols: {
			controls: [
				{ icon: '<i class="fa fa-pen-square"></i>',
				title: 'Toggle chalkboard (B)',
				action: 'RevealChalkboard.toggleChalkboard();'
				},
				{ icon: '<i class="fa fa-pen"></i>',
				title: 'Toggle notes canvas (C)',
				action: 'RevealChalkboard.toggleNotesCanvas();'
				},
			]
		},
		menu: {
			loadIcons: false
		}
      };

      // options from URL query string
      var queryOptions = Reveal().getQueryHash() || {};

      var options = extend(defaultOptions, {"width":960,"height":700,"margin":0.1,"controls":false,"progress":true,"slideNumber":false,"center":true,"previewLinks":true,"transition":"slide","transitionSpeed":"normal"}, queryOptions);
    </script>

    <script>
      Reveal.initialize(options);
    </script>
  </body>

  <!-- created with Advanced Slides -->
</html>
